<html>
<!--********************************************************************
'*
'*  File:           useradd.htm
'*  Created:        Augustus 2004
'*  Version:        1.0
'*  Author:         Marcel Jussen
'*
'*  Description:    NedCar user Management scripts.  
'*
'*  Copyright (C) 2004 KPN Telecom
'*
'********************************************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Main</title>
<link href="css/nedcarum.css" rel="stylesheet" type="text/css" />

<SCRIPT Language="VBScript">

Option Explicit

sub OnLoad
	const ForReading=1
	dim strHTML, strDomainName, strInfoFile, strRLine, objFile
	dim nPtr, strCell
	dim WshShell, WshNetwork, objFSO, WshSysEnv
	dim cellNew, rowNew
	dim strTemp
	
	Set objFSO = CreateObject("Scripting.FileSystemObject")
	Set WshNetwork = CreateObject("WScript.Network")
	strDomainName = WshNetwork.UserDomain
	
	strInfoFile="C:\NEDCARUM2\info.txt"
	
	If objFso.FileExists(strInfoFile) Then
		set objFSO = CreateObject("Scripting.FileSystemObject")
		set objFile = objFSO.OpenTextFile(strInfoFile, ForReading, True)
		Do While Not objFile.atEndOfStream
    			strRLine = Trim(ObjFile.ReadLine())    			
			set rowNew = tbNewUSers.InsertRow()
			set cellNew = rowNew.InsertCell()
    			If Len(strRLine) > 0 Then
    				cellnew.innerHTML = "<TH width=""10""></TH>"
    				nPtr = InStr(strRLine, ";")
    				do while nPtr > 0
    					strCell=Left(strRline, nPtr-1)
    					strRLine=Mid(strRline, nPtr+1)
  					set cellNew = rowNew.InsertCell()
					cellnew.innerText = strCell
					nPtr = InStr(strRLine, ";")
    				loop	
    				if Len(strRLine) > 0 then
    					set cellNew = rowNew.InsertCell()
					cellnew.innerText = strRLine
    				end if
    			else
    				cellnew.innerHTML = "<th scope=""row"">&nbsp;</th>"
    			End If
	  	Loop
	Else
		call MsgBox("Cannot read " & strInfoFile, 16, "Error")
	End If
	
	'Check environment variables.
	
	Set WshShell = CreateObject("WScript.Shell")
	Set WshSysEnv = WshShell.Environment("PROCESS")
		
	' strTemp = WshSysEnv("PDC")
	' if len(strTemp) <= 0 then call MsgBox("Environment is not correct [PDC] " & strTemp, 16, "Error")
	' strTemp = WshSysEnv("DOMAIN")
	' if len(strTemp) <= 0 then call MsgBox("Environment is not correct [DOMAIN] " & strTemp, 16, "Error")
	
	strTemp = WshSysEnv("NEDCARUM2LOG")
	if len(strTemp) <= 0 then call MsgBox("Environment is not correct [NEDCARUM2LOG] " & strTemp, 16, "Error")
	 
	strTemp = WshSysEnv("homecomputer")
	if len(strTemp) <= 0 then call MsgBox("Environment is not correct [homecomputer] " & strTemp, 16, "Error")
	strTemp = WshSysEnv("homefolder")
	if len(strTemp) <= 0 then call MsgBox("Environment is not correct [homefolder] " & strTemp, 16, "Error")
	strTemp = WshSysEnv("homelocation")
	if len(strTemp) <= 0 then call MsgBox("Environment is not correct [homelocation] " & strTemp, 16, "Error")

	strTemp = WshSysEnv("ctxcomputer")
	if len(strTemp) <= 0 then call MsgBox("Environment is not correct [ctxcomputer] " & strTemp, 16, "Error")
	strTemp = WshSysEnv("ctxfolder")
	if len(strTemp) <= 0 then call MsgBox("Environment is not correct [ctxfolder] " & strTemp, 16, "Error")
	
	call AddToLog(String(40,"-"))
	call AddToLog("NedCar UM Session started")
	call AddToLog("Logging file: " & WshSysEnv("NEDCARUM2LOG"))
	call AddToLog(String(40,"-"))

end Sub

Sub AddToLog(strText)
	const	ForAppend 	= 8	
	const	htmSource	= "Main"
	
	dim WshNetwork, fsoObj, f, strTemp
	dim strDomain, strComputer, strUsername
	dim strTime
	
	Set WshNetwork = CreateObject("WScript.Network")
	strComputer = WshNetwork.ComputerName
  strUsername = WshNetwork.UserName
	strTime = Now()
	
	dim WshShell, wshSysEnv, strLogFile
	Set WshShell = CreateObject("WScript.Shell")
	Set WshSysEnv = WshShell.Environment("PROCESS")	
	strLogFile = WshSysEnv("NEDCARUM2LOG")
	
	Set fsoObj = CreateObject("Scripting.FileSystemObject")
 	Set f = fsoObj.OpenTextFile(strLogFile, ForAppend, True)
 	strTemp = strTime & Chr(32) & htmSource & ", " & strComputer & ", " & strUsername & ", " & strText
 	f.WriteLine strTemp
 	f.Close
End Sub

</SCRIPT>

<style type="text/css">
<!--
.style1 {
	color: #FFFFFF
	}
body {
	background-image: url(graphics/bg.gif);
}
.style2 {
	color: #FFFFCC;
    font-family: Geneva, Arial, Helvetica, sans-serif;
	font-size: large;
	font-weight: bold;
}
-->
</style>
</head>
<body class="nedcarum" onload="OnLoad()">

<div align="left">
  <TABLE WIDTH=700 BORDER=0 CELLPADDING=0 CELLSPACING=0 BGCOLOR=#FFFFFF>
    <TR>
      <TD COLSPAN=2><IMG SRC="graphics/content1_corner_image.jpg" WIDTH=230 HEIGHT=81 ALT=""></TD>
      <TD width="79%" COLSPAN=3 valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0" height="81">
          <tr>
            <td valign="top"><div align="left"></div><table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                  <td width="14%" height="78"><div align="center"><b></b>
                        <font size="2" face="Arial, Helvetica, sans-serif"><font color="#FF6600"><i><img src="graphics/kpn.gif" width="49" height="63"></i></font></font></div></td>
                  <td width="80%"><div align="right"><font size="2" face="Arial, Helvetica, sans-serif">
                      <font color="#FF6600"><i><font color="#333333" face="Times New Roman, Times, serif">
                      NedCar Company LAN Windows User Management.<br>
                      KPN Telecom/BU IMS/BI SECTOR 2/NedCar<br>
                      Marcel Jussen</font></i></font></font></div></td>
                  <td width="6%">&nbsp;</td>
                </tr>
              </table></td>
          </tr>
      </table></TD>
    </TR>
    <TR>
      <TD COLSPAN=5>
	    <table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#959999">
          <tr>
            <td bgcolor="#95AAAB"><object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0" width="740" height="102">
                <param name=movie value="graphics/content1_flash.swf">
                <param name=quality value=high>
                <embed src="graphics/content1_flash.swf" quality=high pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="740" height="102"> </embed>
            </object></td>
          </tr>
        </table>
      </TD>
    </TR>
  </TABLE>
  <table width="815" border="0" cellpadding="0" cellspacing="0" class="nedcaruminfo">
    <THEAD>
      <TR bgcolor="#000000">
        <TH width="10"></TH>
        <TH align="left" ><span class="style1"><strong>Date</strong></span></TH>
        <TH align="left" ><span class="style1"><strong>User</strong></span></TH>
        <TH align="left" ><span class="style1"><strong>Comments</strong></span></TH>
      </TR>
    </THEAD>
    <TBODY ID = "tbNewUsers">
    </TBODY>
  </TABLE>
  <table width="815" border="0" cellpadding="0" cellspacing="0" class="nedcaruminfo">
    <tr>
      <th height="60%" scope="row">&nbsp;</th>
    </tr>
  </TABLE>
</div>
</body>
</html>
